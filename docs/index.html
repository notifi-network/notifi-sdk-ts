<!DOCTYPE html><html class="default"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@notifi-network/notifi-react-hooks</title><meta name="description" content="Documentation for @notifi-network/notifi-react-hooks"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.body.classList.add(localStorage.getItem("tsd-theme") || "os")</script><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">@notifi-network/notifi-react-hooks</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label><input type="checkbox" id="tsd-filter-externals" checked/><label class="tsd-widget" for="tsd-filter-externals">Externals</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><h1>@notifi-network/notifi-react-hooks</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><div class="tsd-panel tsd-typography">
<a href="#notifinotifi-react-hooks" id="notifinotifi-react-hooks" style="color: inherit; text-decoration: none;">
  <h1><code>@notifi/notifi-react-hooks</code></h1>
</a>
<blockquote>
<p><em>Updated July 14, 2022</em></p>
</blockquote>

<a href="#üôãüèª‚ôÄÔ∏è-introduction" id="üôãüèª‚ôÄÔ∏è-introduction" style="color: inherit; text-decoration: none;">
  <h2>üôãüèª‚Äç‚ôÄÔ∏è Introduction</h2>
</a>
<p>Notifi provides notification infrastructure for web3 services and dApps to communicate with their end users.</p>
<p><code>notifi-react-hooks</code> is an SDK designed for React dApp developers to integrate Notifi&#39;s services via an easy-to-use Hooks interface.</p>
<p>To see the latest updates on supported L1 and messaging channels and to see what&#39;s coming up, check out <a href="www.notifi.network">Notifi.Network</a> and join the <a href="https://discord.com/invite/nAqR3mk3rv">Discord Community</a>.</p>
<p>To use Notifi, dApps need to onboard to Notifi&#39;s services and users are required to authenticate their wallet address by connecting their wallet and signing for the transaction to get notifications.</p>
<p>Currently supported notifications:</p>
<ul>
<li>Email Notifications</li>
<li>SMS Notifications to mobile numbers with country code (ex: +15557771234)</li>
<li>Telegram (Ask our Discord #integration-requests channel for help setting up your bot! <a href="https://discord.com/channels/939658182509334538/950415885619843082">https://discord.com/channels/939658182509334538/950415885619843082</a>)</li>
</ul>

<a href="#üé¨-getting-started" id="üé¨-getting-started" style="color: inherit; text-decoration: none;">
  <h2>üé¨ Getting Started</h2>
</a>
<p>In this README, we&#39;ll cover the simple use case of one user creating one alert for one wallet address. These patterns can be extended for more complex use cases where there are multiple alerts on several wallets with specific filters for each.</p>

<a href="#üìö-prerequistes" id="üìö-prerequistes" style="color: inherit; text-decoration: none;">
  <h2>üìö Prerequistes</h2>
</a>
<ol>
<li>Join the <a href="https://discord.com/invite/nAqR3mk3rv">Discord Community</a> to get support</li>
<li>Hit up the devs in the <a href="https://discord.com/channels/939658182509334538/950415885619843082">#integration-requests</a> channel to get onboarded to Notifi&#39;s services</li>
</ol>

<a href="#üì•-installation" id="üì•-installation" style="color: inherit; text-decoration: none;">
  <h2>üì• Installation</h2>
</a>
<pre><code><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-0">i</span><span class="hl-1"> @</span><span class="hl-0">notifi</span><span class="hl-1">-</span><span class="hl-0">network</span><span class="hl-1">/</span><span class="hl-0">notifi</span><span class="hl-1">-</span><span class="hl-0">react</span><span class="hl-1">-</span><span class="hl-0">hooks</span>
</code></pre>

<a href="#üß©-build-your-ui-components" id="üß©-build-your-ui-components" style="color: inherit; text-decoration: none;">
  <h2>üß© Build Your UI Components</h2>
</a>
<p>Common patterns for UI involve rendering a form in a modal or card to collect the user&#39;s contact information (Email, SMS, Telegram, etc). Below is are example UIs from the integrations with</p>

<a href="#ü™ù-hook-up-the-sdk" id="ü™ù-hook-up-the-sdk" style="color: inherit; text-decoration: none;">
  <h2>ü™ù Hook up the SDK</h2>
</a>
<p>Load the Notifi React Hooks SDK into your component.</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">notifiReactHooks</span><span class="hl-1"> = </span><span class="hl-4">require</span><span class="hl-1">(</span><span class="hl-5">&#39;@notifi-network/notifi-react-hooks&#39;</span><span class="hl-1">);</span>
</code></pre>
<p>Instantiate and configure the Notifi Client for your dApp and environment. If your user has not connected their wallet, they will need to do so in order to instantiate the client.</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">notifiClient</span><span class="hl-1"> = </span><span class="hl-0">notifiReactHooks</span><span class="hl-1">.</span><span class="hl-4">useNotifiClient</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-0">dappAddress:</span><span class="hl-1"> &lt;</span><span class="hl-6">dApp</span><span class="hl-1"> </span><span class="hl-6">ID</span><span class="hl-1">&gt;,</span><br/><span class="hl-1">  </span><span class="hl-0">env:</span><span class="hl-1"> </span><span class="hl-0">BlockchainEnvironment</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">walletPublicKey:</span><span class="hl-1"> &lt;</span><span class="hl-6">Connected</span><span class="hl-1"> </span><span class="hl-6">Wallet</span><span class="hl-1"> </span><span class="hl-6">Public</span><span class="hl-1"> </span><span class="hl-6">Key</span><span class="hl-1">&gt;,</span><br/><span class="hl-1">});</span>
</code></pre>
<blockquote>
<p>üìù Onboard your dApp with Notifi to get your &quot;dApp ID&quot; on the allowlist via the Discord #integration-requests channel <a href="https://discord.com/channels/939658182509334538/950415885619843082">https://discord.com/channels/939658182509334538/950415885619843082</a></p>
</blockquote>

<a href="#üîè-signature-authorization" id="üîè-signature-authorization" style="color: inherit; text-decoration: none;">
  <h2>üîè Signature Authorization</h2>
</a>
<p>For a user to opt-in for notifications, they will need to provide their signature. This signature will then be used to authorize the user&#39;s connected wallet address with Notifi and create the account with Notifi.</p>
<p>Using the wallet adapter of your choice, prompt the user to sign and use the signed message in the <code>logIn()</code> hook.</p>
<p>If the server responds with an error, the hook will throw an error of the <a href="https://notifi-network.github.io/notifi-sdk-ts/classes/GqlError.html">type <code>GqlError</code></a>.</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">logIn</span><span class="hl-1">} = </span><span class="hl-0">notifiClient</span><span class="hl-1">;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">handleLogIn</span><span class="hl-1"> = () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">await</span><span class="hl-1"> </span><span class="hl-4">logIn</span><span class="hl-1">({</span><span class="hl-0">signMessage:</span><span class="hl-1"> &lt;</span><span class="hl-6">Signature</span><span class="hl-1">&gt;})</span><br/><span class="hl-1">  } </span><span class="hl-7">catch</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1"> </span><span class="hl-2">instanceof</span><span class="hl-1"> </span><span class="hl-6">GqlError</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-8">// handle the Notifi GqlError</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/>
</code></pre>
<blockquote>
<p>üìù The signature type will vary depending on the wallet adapter. Connect with the Notifi devs to ensure success for your scenario</p>
</blockquote>

<a href="#üïπ-rendering-alert-options" id="üïπ-rendering-alert-options" style="color: inherit; text-decoration: none;">
  <h2>üïπ Rendering Alert Options</h2>
</a>
<p>After the user successfully authorizes, fetch the newly created user data from Notifi using the <code>fetchData()</code> hook. This returns the <a href="https://notifi-network.github.io/notifi-sdk-ts/modules.html#ClientData">type <code>ClientData</code></a>.</p>
<p>In our simplest use case, the user will have 1 entry in the <code>sources</code> array, which will be based on their connected wallet address. More about the <a href="https://notifi-network.github.io/notifi-sdk-ts/modules.html#Source"><code>Source</code> type here</a>. Use the id of the source when creating the alert later on.</p>
<p>For Metaplex/Bonfida auction sources, we provide hooks to help create the sources: createMetaplexAuctionSource and createBonfidaAuctionSource
This allows the caller to specify the auction ID, along with an auction name or URL for a user to receive in their notifications.</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">fetchData</span><span class="hl-1">} = </span><span class="hl-0">notifiClient</span><span class="hl-1">;</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">data</span><span class="hl-1"> = </span><span class="hl-4">fetchData</span><span class="hl-1">();</span><br/><br/><span class="hl-8">// An array of sources that belong to the user</span><br/><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">sources</span><span class="hl-1">} = </span><span class="hl-0">data</span><span class="hl-1">;</span>
</code></pre>
<p>You&#39;ll want to render the alert options available for the user&#39;s source, based on what is returned in the source&#39;s <code>applicableFilters</code> array. More about the <a href="https://notifi-network.github.io/notifi-sdk-ts/modules.html#Filter"><code>Filter</code> type here</a>.</p>
<p>There are a handful of available options for different sources with new options on the horizon. Join the <a href="https://discord.com/invite/nAqR3mk3rv">Discord Community</a> to get the latest updates.</p>
<pre><code><span class="hl-8">// Render the options to the user</span><br/><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">id</span><span class="hl-1">, </span><span class="hl-3">applicableFilters</span><span class="hl-1">} = </span><span class="hl-0">sources</span><span class="hl-1">?.[</span><span class="hl-9">0</span><span class="hl-1">];</span><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">filterId</span><span class="hl-1"> = </span><span class="hl-0">applicableFilters</span><span class="hl-1">?.[</span><span class="hl-9">0</span><span class="hl-1">].</span><span class="hl-0">id</span><span class="hl-1">;</span>
</code></pre>
<p>For more complex scenarios where the user has multiple sources, you may want to iterate over each source to accumulate the applicable filters to render.</p>

<a href="#ü™¢-create-the-alert" id="ü™¢-create-the-alert" style="color: inherit; text-decoration: none;">
  <h2>ü™¢ Create the Alert</h2>
</a>
<p>Once your user enters their contact information and options for their first alert, use the <code>createAlert()</code> hook. This accepts the <a href="https://notifi-network.github.io/notifi-sdk-ts/modules.html#ClientCreateAlertInput">ClientCreateAlertInput shape</a> and will return the <a href="https://notifi-network.github.io/notifi-sdk-ts/modules.html#Alert"><code>Alert</code> object</a> in the response upon success.</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">createAlert</span><span class="hl-1">} = </span><span class="hl-0">notifiClient</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// User Input</span><br/><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">contactInfo</span><span class="hl-1">, </span><span class="hl-3">setContactInfo</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">ContactForm</span><span class="hl-1">&gt;({</span><br/><span class="hl-1">    </span><span class="hl-0">emailAddress:</span><span class="hl-1"> </span><span class="hl-2">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">phoneNumber:</span><span class="hl-1"> </span><span class="hl-2">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">telegramId:</span><span class="hl-1"> </span><span class="hl-2">null</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">filterId</span><span class="hl-1">, </span><span class="hl-3">setFilterId</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">string</span><span class="hl-1">&gt;(</span><span class="hl-5">&#39;&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-1">...</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">handleCreateAlert</span><span class="hl-1"> () =&gt; {</span><br/><span class="hl-1">  try {</span><br/><span class="hl-1">    const </span><span class="hl-0">response</span><span class="hl-1"> = </span><span class="hl-7">await</span><span class="hl-1"> </span><span class="hl-4">createAlert</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-0">emailAddress:</span><span class="hl-1"> </span><span class="hl-0">contactInfo</span><span class="hl-1">.</span><span class="hl-0">emailAddress</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">filterId:</span><span class="hl-1"> </span><span class="hl-0">filterId</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-5">&#39;my first gmgn dApp unique notification name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">phoneNumber:</span><span class="hl-1"> </span><span class="hl-0">contactInfo</span><span class="hl-1">.</span><span class="hl-0">phoneNumber</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">sourceId:</span><span class="hl-1"> </span><span class="hl-0">sources</span><span class="hl-1">?.[</span><span class="hl-9">0</span><span class="hl-1">]?.</span><span class="hl-0">id</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">telegramId:</span><span class="hl-1"> </span><span class="hl-0">contactInfo</span><span class="hl-1">.</span><span class="hl-0">telegramId</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    return response;</span><br/><span class="hl-1">  } </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1"> </span><span class="hl-0">instanceof</span><span class="hl-1"> </span><span class="hl-0">GqlError</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-8">// handle the Notifi GqlError</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/>
</code></pre>
<p>This input also accepts a <a href="https://notifi-network.github.io/notifi-sdk-ts/modules.html#FilterOptions"><code>filterOptions</code> parameter</a>, if applicable for the chosen filter type, to configure the conditions of when a notification gets triggered:</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">createAlert</span><span class="hl-1">} = </span><span class="hl-0">notifiClient</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// User Input</span><br/><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">contactInfo</span><span class="hl-1">, </span><span class="hl-3">setContactInfo</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">ContactForm</span><span class="hl-1">&gt;({</span><br/><span class="hl-1">    </span><span class="hl-0">emailAddress:</span><span class="hl-1"> </span><span class="hl-2">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">phoneNumber:</span><span class="hl-1"> </span><span class="hl-2">null</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-0">telegramId:</span><span class="hl-1"> </span><span class="hl-2">null</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">filterId</span><span class="hl-1">, </span><span class="hl-3">setFilterId</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">string</span><span class="hl-1">&gt;(</span><span class="hl-5">&#39;&#39;</span><span class="hl-1">);</span><br/><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">health</span><span class="hl-1">, </span><span class="hl-3">setHealth</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">number</span><span class="hl-1">&gt;(</span><span class="hl-9">10</span><span class="hl-1">);</span><br/><br/><span class="hl-1">...</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">handleCreateAlert</span><span class="hl-1"> () =&gt; {</span><br/><span class="hl-1">  try {</span><br/><span class="hl-1">    const </span><span class="hl-0">response</span><span class="hl-1"> = </span><span class="hl-7">await</span><span class="hl-1"> </span><span class="hl-4">createAlert</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-0">emailAddress:</span><span class="hl-1"> </span><span class="hl-0">contactInfo</span><span class="hl-1">.</span><span class="hl-0">emailAddress</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">filterId:</span><span class="hl-1"> </span><span class="hl-0">filterId</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">filterOptions:</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">alertFrequency:</span><span class="hl-1"> </span><span class="hl-5">&#39;SINGLE&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-0">threshold:</span><span class="hl-1"> </span><span class="hl-0">health</span><span class="hl-1">,</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-5">&#39;my first gmgn dApp unique notification name&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">phoneNumber:</span><span class="hl-1"> </span><span class="hl-0">contactInfo</span><span class="hl-1">.</span><span class="hl-0">phoneNumber</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">sourceId:</span><span class="hl-1"> </span><span class="hl-0">sources</span><span class="hl-1">?.[</span><span class="hl-9">0</span><span class="hl-1">]?.</span><span class="hl-0">id</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">telegramId:</span><span class="hl-1"> </span><span class="hl-0">contactInfo</span><span class="hl-1">.</span><span class="hl-0">telegramId</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    return response;</span><br/><span class="hl-1">  } </span><span class="hl-4">catch</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-4">if</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1"> </span><span class="hl-0">instanceof</span><span class="hl-1"> </span><span class="hl-0">GqlError</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-8">// handle the Notifi GqlError</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/>
</code></pre>

<a href="#üîÉ-updating-the-alert" id="üîÉ-updating-the-alert" style="color: inherit; text-decoration: none;">
  <h2>üîÉ Updating the Alert</h2>
</a>
<p>If a user wants to update their alert by changing the email address notifications are sent to, or to add a phone number for SMS notifications, updating the alert is handled by using the <code>updateAlert()</code> hook. It takes the <a href="https://notifi-network.github.io/notifi-sdk-ts/modules.html#ClientUpdateAlertInput">type <code>ClientUpdateAlertInput</code></a>.</p>
<p>You&#39;ll want to pass in the <code>id</code> of the existing alert to make the update to that alert entity. In our simplest use case, where the user only has 1 alert in their account, fetch the user&#39;s persisted data using <code>fetchData()</code> and get the id of the alert to delete.</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">fetchData</span><span class="hl-1">, </span><span class="hl-3">updateAlert</span><span class="hl-1">} = </span><span class="hl-0">notifiClient</span><span class="hl-1">;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">handleUpdateAlert</span><span class="hl-1"> = () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">alerts</span><span class="hl-1">} = </span><span class="hl-4">fetchData</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">response</span><span class="hl-1"> = </span><span class="hl-7">await</span><span class="hl-1"> </span><span class="hl-4">updateAlert</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-0">alertId:</span><span class="hl-1"> </span><span class="hl-0">alerts</span><span class="hl-1">?.[</span><span class="hl-9">0</span><span class="hl-1">]?.</span><span class="hl-0">id</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">emailAddress:</span><span class="hl-1"> &lt;</span><span class="hl-6">New</span><span class="hl-1"> </span><span class="hl-6">Email</span><span class="hl-1"> </span><span class="hl-6">Address</span><span class="hl-1"> | </span><span class="hl-6">null</span><span class="hl-1">&gt;,</span><br/><span class="hl-1">      </span><span class="hl-0">phoneNumber:</span><span class="hl-1"> &lt;</span><span class="hl-6">New</span><span class="hl-1"> </span><span class="hl-6">Phone</span><span class="hl-1"> </span><span class="hl-6">Number</span><span class="hl-1"> | </span><span class="hl-6">null</span><span class="hl-1">&gt;,</span><br/><span class="hl-1">      </span><span class="hl-0">telegramId:</span><span class="hl-1"> &lt;</span><span class="hl-6">New</span><span class="hl-1"> </span><span class="hl-6">Telegram</span><span class="hl-1"> </span><span class="hl-6">ID</span><span class="hl-1"> | </span><span class="hl-6">null</span><span class="hl-1">&gt;,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-7">return</span><span class="hl-1"> </span><span class="hl-0">response</span><span class="hl-1">;</span><br/><span class="hl-1">  } </span><span class="hl-7">catch</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1"> </span><span class="hl-2">instanceof</span><span class="hl-1"> </span><span class="hl-6">GqlError</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-8">// handle the Notifi GqlError</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/>
</code></pre>

<a href="#üóë-deleting-the-alert" id="üóë-deleting-the-alert" style="color: inherit; text-decoration: none;">
  <h2>üóë Deleting the Alert</h2>
</a>
<p>To delete an alert, use the <code>deleteAlert()</code> hook, which simply <a href="https://notifi-network.github.io/notifi-sdk-ts/modules.html#ClientDeleteAlertInput">takes the <code>id</code> of the alert</a> to be deleted. In our use case where the user only has 1 alert in their account:</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">fetchData</span><span class="hl-1">, </span><span class="hl-3">deleteAlert</span><span class="hl-1">} = </span><span class="hl-0">notifiClient</span><span class="hl-1">;</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">handleDeleteAlert</span><span class="hl-1"> = () </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-7">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> {</span><span class="hl-3">alerts</span><span class="hl-1">} = </span><span class="hl-4">fetchData</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">response</span><span class="hl-1"> = </span><span class="hl-7">await</span><span class="hl-1"> </span><span class="hl-4">deleteAlert</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-0">alertId:</span><span class="hl-1"> </span><span class="hl-0">alerts</span><span class="hl-1">?.[</span><span class="hl-9">0</span><span class="hl-1">]?.</span><span class="hl-0">id</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-7">return</span><span class="hl-1"> </span><span class="hl-0">response</span><span class="hl-1">;</span><br/><span class="hl-1">  } </span><span class="hl-7">catch</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1"> </span><span class="hl-2">instanceof</span><span class="hl-1"> </span><span class="hl-6">GqlError</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-8">// handle the Notifi GqlError</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code></pre>

<a href="#üßØ-error-handling" id="üßØ-error-handling" style="color: inherit; text-decoration: none;">
  <h2>üßØ Error Handling</h2>
</a>
<p><code>notifi-react-hooks</code> wrap Notifi server errors and throw the <a href="https://notifi-network.github.io/notifi-sdk-ts/classes/GqlError.html">type <code>GqlError</code></a>.</p>
<p>An example of how to handle these errors in clientside code:</p>
<pre><code><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">handleError</span><span class="hl-1"> = (</span><span class="hl-0">errors</span><span class="hl-1">: { </span><span class="hl-0">message</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1"> }[]) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">error</span><span class="hl-1"> = </span><span class="hl-0">errors</span><span class="hl-1">.</span><span class="hl-0">length</span><span class="hl-1"> &gt; </span><span class="hl-9">0</span><span class="hl-1"> ? </span><span class="hl-0">errors</span><span class="hl-1">[</span><span class="hl-9">0</span><span class="hl-1">] : </span><span class="hl-2">null</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">error</span><span class="hl-1"> </span><span class="hl-2">instanceof</span><span class="hl-1"> </span><span class="hl-6">GqlError</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">setErrorMessage</span><span class="hl-1">(</span><br/><span class="hl-1">        </span><span class="hl-5">`</span><span class="hl-2">${</span><span class="hl-0">error</span><span class="hl-10">.</span><span class="hl-0">message</span><span class="hl-2">}</span><span class="hl-5">: </span><span class="hl-2">${</span><span class="hl-0">error</span><span class="hl-10">.</span><span class="hl-4">getErrorMessages</span><span class="hl-10">().</span><span class="hl-4">join</span><span class="hl-10">(</span><span class="hl-5">&#39;, &#39;</span><span class="hl-10">)</span><span class="hl-2">}</span><span class="hl-5">`</span><br/><span class="hl-1">      );</span><br/><span class="hl-1">    } </span><span class="hl-7">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">setErrorMessage</span><span class="hl-1">(</span><span class="hl-0">error</span><span class="hl-1">?.</span><span class="hl-0">message</span><span class="hl-1"> ?? </span><span class="hl-5">&#39;Unknown error&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }</span>
</code></pre>

<a href="#broadcast-message-example" id="broadcast-message-example" style="color: inherit; text-decoration: none;">
  <h2>Broadcast Message Example</h2>
</a>
<p>The following example fetches <code>UserTopics</code> and allows the user to send a message via <code>broadcastMessage</code></p>
<pre><code class="language-tsx"><span class="hl-7">import</span><span class="hl-1"> { </span><span class="hl-0">UserTopic</span><span class="hl-1"> } </span><span class="hl-7">from</span><span class="hl-1"> </span><span class="hl-5">&#39;@notifi-network/notifi-core&#39;</span><span class="hl-1">;</span><br/><span class="hl-7">import</span><span class="hl-1"> </span><span class="hl-7">type</span><span class="hl-1"> { </span><span class="hl-0">MessageSigner</span><span class="hl-1"> } </span><span class="hl-7">from</span><span class="hl-1"> </span><span class="hl-5">&#39;@notifi-network/notifi-react-hooks&#39;</span><span class="hl-1">;</span><br/><span class="hl-7">import</span><span class="hl-1"> { </span><span class="hl-0">useNotifiClient</span><span class="hl-1"> } </span><span class="hl-7">from</span><span class="hl-1"> </span><span class="hl-5">&#39;@notifi-network/notifi-react-hooks&#39;</span><span class="hl-1">;</span><br/><span class="hl-7">import</span><span class="hl-1"> </span><span class="hl-0">React</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-0">useCallback</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">useEffect</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">useMemo</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">useRef</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">useState</span><span class="hl-1">,</span><br/><span class="hl-1">} </span><span class="hl-7">from</span><span class="hl-1"> </span><span class="hl-5">&#39;react&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-2">type</span><span class="hl-1"> </span><span class="hl-6">Props</span><span class="hl-1"> = </span><span class="hl-6">Readonly</span><span class="hl-1">&lt;{</span><br/><span class="hl-1">  </span><span class="hl-0">dappAddress</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">signer</span><span class="hl-1">: </span><span class="hl-6">MessageSigner</span><span class="hl-1">;</span><br/><span class="hl-1">  </span><span class="hl-0">walletPublicKey</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">;</span><br/><span class="hl-1">}&gt;;</span><br/><br/><span class="hl-7">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-4">ConnectedForm</span><span class="hl-1">: </span><span class="hl-6">React</span><span class="hl-1">.</span><span class="hl-6">FC</span><span class="hl-1">&lt;</span><span class="hl-6">Props</span><span class="hl-1">&gt; = ({</span><br/><span class="hl-1">  </span><span class="hl-0">dappAddress</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">signer</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-0">walletPublicKey</span><span class="hl-1">,</span><br/><span class="hl-1">}) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">topics</span><span class="hl-1">, </span><span class="hl-3">setTopics</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">ReadonlyArray</span><span class="hl-1">&lt;</span><span class="hl-6">UserTopic</span><span class="hl-1">&gt;&gt;([]);</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">topic</span><span class="hl-1">, </span><span class="hl-3">setTopic</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">UserTopic</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">&gt;(</span><span class="hl-2">undefined</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">shouldFetch</span><span class="hl-1"> = </span><span class="hl-4">useRef</span><span class="hl-1">(</span><span class="hl-2">true</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> { </span><span class="hl-3">broadcastMessage</span><span class="hl-1">, </span><span class="hl-3">getTopics</span><span class="hl-1">, </span><span class="hl-3">logIn</span><span class="hl-1">, </span><span class="hl-3">logOut</span><span class="hl-1">, </span><span class="hl-3">isAuthenticated</span><span class="hl-1"> } =</span><br/><span class="hl-1">    </span><span class="hl-4">useNotifiClient</span><span class="hl-1">({</span><br/><span class="hl-1">      </span><span class="hl-0">dappAddress</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">walletPublicKey</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">env:</span><span class="hl-1"> </span><span class="hl-5">&#39;Development&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    });</span><br/><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">subject</span><span class="hl-1">, </span><span class="hl-3">setSubject</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">string</span><span class="hl-1">&gt;(</span><span class="hl-5">&#39;&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">message</span><span class="hl-1">, </span><span class="hl-3">setMessage</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">string</span><span class="hl-1">&gt;(</span><span class="hl-5">&#39;&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> [</span><span class="hl-3">isHolderOnly</span><span class="hl-1">, </span><span class="hl-3">setIsHolderOnly</span><span class="hl-1">] = </span><span class="hl-4">useState</span><span class="hl-1">&lt;</span><span class="hl-6">boolean</span><span class="hl-1">&gt;(</span><span class="hl-2">true</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-4">useEffect</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">isAuthenticated</span><span class="hl-1"> &amp;&amp; </span><span class="hl-0">shouldFetch</span><span class="hl-1">.</span><span class="hl-0">current</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">shouldFetch</span><span class="hl-1">.</span><span class="hl-0">current</span><span class="hl-1"> = </span><span class="hl-2">false</span><span class="hl-1">;</span><br/><br/><span class="hl-1">      </span><span class="hl-4">getTopics</span><span class="hl-1">()</span><br/><span class="hl-1">        .</span><span class="hl-4">then</span><span class="hl-1">((</span><span class="hl-0">topics</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-4">setTopics</span><span class="hl-1">(</span><span class="hl-0">topics</span><span class="hl-1">);</span><br/><span class="hl-1">          </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">topic</span><span class="hl-1"> === </span><span class="hl-2">undefined</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-4">setTopic</span><span class="hl-1">(</span><span class="hl-0">topics</span><span class="hl-1">[</span><span class="hl-9">0</span><span class="hl-1">]);</span><br/><span class="hl-1">          }</span><br/><span class="hl-1">        })</span><br/><span class="hl-1">        .</span><span class="hl-4">catch</span><span class="hl-1">((</span><span class="hl-0">e</span><span class="hl-1">: </span><span class="hl-6">unknown</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">          </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error getting topics&#39;</span><span class="hl-1">, </span><span class="hl-0">e</span><span class="hl-1">);</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (!</span><span class="hl-0">isAuthenticated</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-0">shouldFetch</span><span class="hl-1">.</span><span class="hl-0">current</span><span class="hl-1"> = </span><span class="hl-2">true</span><span class="hl-1">;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  }, [</span><span class="hl-0">getTopics</span><span class="hl-1">, </span><span class="hl-0">isAuthenticated</span><span class="hl-1">, </span><span class="hl-0">topic</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> { </span><span class="hl-3">topicsKeys</span><span class="hl-1">, </span><span class="hl-3">topicsMap</span><span class="hl-1"> } = </span><span class="hl-4">useMemo</span><span class="hl-1">(() </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">map</span><span class="hl-1"> = </span><span class="hl-0">topics</span><span class="hl-1">.</span><span class="hl-4">reduce</span><span class="hl-1">((</span><span class="hl-0">m</span><span class="hl-1">, </span><span class="hl-0">topic</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">topic</span><span class="hl-1">.</span><span class="hl-0">topicName</span><span class="hl-1"> !== </span><span class="hl-2">null</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-0">m</span><span class="hl-1">[</span><span class="hl-0">topic</span><span class="hl-1">.</span><span class="hl-0">topicName</span><span class="hl-1">] = </span><span class="hl-0">topic</span><span class="hl-1">;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-7">return</span><span class="hl-1"> </span><span class="hl-0">m</span><span class="hl-1">;</span><br/><span class="hl-1">    }, {} </span><span class="hl-7">as</span><span class="hl-1"> </span><span class="hl-6">Record</span><span class="hl-1">&lt;</span><span class="hl-6">string</span><span class="hl-1">, </span><span class="hl-6">UserTopic</span><span class="hl-1">&gt;);</span><br/><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">keys</span><span class="hl-1"> = </span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-4">keys</span><span class="hl-1">(</span><span class="hl-0">map</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">return</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">topicsKeys:</span><span class="hl-1"> </span><span class="hl-0">keys</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-0">topicsMap:</span><span class="hl-1"> </span><span class="hl-0">map</span><span class="hl-1">,</span><br/><span class="hl-1">    };</span><br/><span class="hl-1">  }, [</span><span class="hl-0">topics</span><span class="hl-1">]);</span><br/><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">handleSubmit</span><span class="hl-1"> = </span><span class="hl-4">useCallback</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-2">async</span><span class="hl-1"> (</span><span class="hl-0">t</span><span class="hl-1">: </span><span class="hl-6">UserTopic</span><span class="hl-1"> | </span><span class="hl-6">undefined</span><span class="hl-1">, </span><span class="hl-0">s</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">, </span><span class="hl-0">m</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">, </span><span class="hl-0">i</span><span class="hl-1">: </span><span class="hl-6">boolean</span><span class="hl-1">) </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">t</span><span class="hl-1"> === </span><span class="hl-2">undefined</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-7">return</span><span class="hl-1">;</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-7">try</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">broadcastMessage</span><span class="hl-1">(</span><br/><span class="hl-1">          {</span><br/><span class="hl-1">            </span><span class="hl-0">topic:</span><span class="hl-1"> </span><span class="hl-0">t</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-0">subject:</span><span class="hl-1"> </span><span class="hl-0">s</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-0">message:</span><span class="hl-1"> </span><span class="hl-0">m</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-0">isHolderOnly:</span><span class="hl-1"> </span><span class="hl-0">i</span><span class="hl-1">,</span><br/><span class="hl-1">          },</span><br/><span class="hl-1">          </span><span class="hl-0">signer</span><span class="hl-1">,</span><br/><span class="hl-1">        );</span><br/><span class="hl-1">      } </span><span class="hl-7">catch</span><span class="hl-1"> (</span><span class="hl-0">e</span><span class="hl-1">: </span><span class="hl-6">unknown</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-0">console</span><span class="hl-1">.</span><span class="hl-4">log</span><span class="hl-1">(</span><span class="hl-5">&#39;Error during broadcastMessage&#39;</span><span class="hl-1">, </span><span class="hl-0">e</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    [</span><span class="hl-0">broadcastMessage</span><span class="hl-1">, </span><span class="hl-0">signer</span><span class="hl-1">],</span><br/><span class="hl-1">  );</span><br/><br/><span class="hl-1">  </span><span class="hl-7">return</span><span class="hl-1"> (</span><br/><span class="hl-1">    </span><span class="hl-11">&lt;</span><span class="hl-12">div</span><span class="hl-11">&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-12">h1</span><span class="hl-11">&gt;</span><span class="hl-1">Send Broadcast Message</span><span class="hl-11">&lt;/</span><span class="hl-12">h1</span><span class="hl-11">&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-12">select</span><br/><span class="hl-1">        </span><span class="hl-13">value</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-0">topic</span><span class="hl-10">?.</span><span class="hl-0">topicName</span><span class="hl-10"> </span><span class="hl-1">??</span><span class="hl-10"> </span><span class="hl-5">&#39;&#39;</span><span class="hl-2">}</span><br/><span class="hl-1">        </span><span class="hl-13">onChange</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-10">(</span><span class="hl-0">e</span><span class="hl-10">) </span><span class="hl-2">=&gt;</span><span class="hl-10"> {</span><br/><span class="hl-10">          </span><span class="hl-2">const</span><span class="hl-10"> </span><span class="hl-3">name</span><span class="hl-10"> </span><span class="hl-1">=</span><span class="hl-10"> </span><span class="hl-0">e</span><span class="hl-10">.</span><span class="hl-0">target</span><span class="hl-10">.</span><span class="hl-0">value</span><span class="hl-10">;</span><br/><span class="hl-10">          </span><span class="hl-4">setTopic</span><span class="hl-10">(</span><span class="hl-0">topicsMap</span><span class="hl-10">[</span><span class="hl-0">name</span><span class="hl-10">]);</span><br/><span class="hl-10">        }</span><span class="hl-2">}</span><br/><span class="hl-1">      </span><span class="hl-11">&gt;</span><br/><span class="hl-1">        </span><span class="hl-2">{</span><span class="hl-0">topicsKeys</span><span class="hl-10">.</span><span class="hl-4">map</span><span class="hl-10">((</span><span class="hl-0">key</span><span class="hl-10">) </span><span class="hl-2">=&gt;</span><span class="hl-10"> {</span><br/><span class="hl-10">          </span><span class="hl-7">return</span><span class="hl-10"> (</span><br/><span class="hl-10">            </span><span class="hl-11">&lt;</span><span class="hl-12">option</span><span class="hl-10"> </span><span class="hl-13">key</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-0">key</span><span class="hl-2">}</span><span class="hl-10"> </span><span class="hl-13">value</span><span class="hl-1">=</span><span class="hl-5">&quot;key&quot;</span><span class="hl-11">&gt;</span><br/><span class="hl-10">              </span><span class="hl-2">{</span><span class="hl-0">topicsMap</span><span class="hl-10">[</span><span class="hl-0">key</span><span class="hl-10">].</span><span class="hl-0">name</span><span class="hl-2">}</span><br/><span class="hl-10">            </span><span class="hl-11">&lt;/</span><span class="hl-12">option</span><span class="hl-11">&gt;</span><br/><span class="hl-10">          );</span><br/><span class="hl-10">        })</span><span class="hl-2">}</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;/</span><span class="hl-12">select</span><span class="hl-11">&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-12">input</span><br/><span class="hl-1">        </span><span class="hl-13">type</span><span class="hl-1">=</span><span class="hl-5">&quot;text&quot;</span><br/><span class="hl-1">        </span><span class="hl-13">value</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-0">subject</span><span class="hl-2">}</span><br/><span class="hl-1">        </span><span class="hl-13">onChange</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-10">(</span><span class="hl-0">e</span><span class="hl-10">) </span><span class="hl-2">=&gt;</span><span class="hl-10"> </span><span class="hl-4">setSubject</span><span class="hl-10">(</span><span class="hl-0">e</span><span class="hl-10">.</span><span class="hl-0">target</span><span class="hl-10">.</span><span class="hl-0">value</span><span class="hl-10">)</span><span class="hl-2">}</span><br/><span class="hl-1">      </span><span class="hl-11">/&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-12">textarea</span><span class="hl-1"> </span><span class="hl-13">value</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-0">message</span><span class="hl-2">}</span><span class="hl-1"> </span><span class="hl-13">onChange</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-10">(</span><span class="hl-0">e</span><span class="hl-10">) </span><span class="hl-2">=&gt;</span><span class="hl-10"> </span><span class="hl-4">setMessage</span><span class="hl-10">(</span><span class="hl-0">e</span><span class="hl-10">.</span><span class="hl-0">target</span><span class="hl-10">.</span><span class="hl-0">value</span><span class="hl-10">)</span><span class="hl-2">}</span><span class="hl-1"> </span><span class="hl-11">/&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-12">input</span><br/><span class="hl-1">        </span><span class="hl-13">type</span><span class="hl-1">=</span><span class="hl-5">&quot;checkbox&quot;</span><br/><span class="hl-1">        </span><span class="hl-13">checked</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-0">isHolderOnly</span><span class="hl-2">}</span><br/><span class="hl-1">        </span><span class="hl-13">onChange</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-10">(</span><span class="hl-0">e</span><span class="hl-10">) </span><span class="hl-2">=&gt;</span><span class="hl-10"> </span><span class="hl-4">setIsHolderOnly</span><span class="hl-10">(</span><span class="hl-0">e</span><span class="hl-10">.</span><span class="hl-0">target</span><span class="hl-10">.</span><span class="hl-0">checked</span><span class="hl-10">)</span><span class="hl-2">}</span><br/><span class="hl-1">      </span><span class="hl-11">&gt;&lt;/</span><span class="hl-12">input</span><span class="hl-11">&gt;</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;</span><span class="hl-12">button</span><br/><span class="hl-1">        </span><span class="hl-13">onClick</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-10">() </span><span class="hl-2">=&gt;</span><span class="hl-10"> </span><span class="hl-4">handleSubmit</span><span class="hl-10">(</span><span class="hl-0">topic</span><span class="hl-10">, </span><span class="hl-0">subject</span><span class="hl-10">, </span><span class="hl-0">message</span><span class="hl-10">, </span><span class="hl-0">isHolderOnly</span><span class="hl-10">)</span><span class="hl-2">}</span><br/><span class="hl-1">      </span><span class="hl-11">&gt;</span><br/><span class="hl-1">        Submit</span><br/><span class="hl-1">      </span><span class="hl-11">&lt;/</span><span class="hl-12">button</span><span class="hl-11">&gt;</span><br/><span class="hl-1">      </span><span class="hl-2">{</span><span class="hl-0">isAuthenticated</span><span class="hl-10"> </span><span class="hl-1">?</span><span class="hl-10"> (</span><br/><span class="hl-10">        </span><span class="hl-11">&lt;</span><span class="hl-12">button</span><br/><span class="hl-10">          </span><span class="hl-13">onClick</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-10">() </span><span class="hl-2">=&gt;</span><span class="hl-10"> {</span><br/><span class="hl-10">            </span><span class="hl-4">logOut</span><span class="hl-10">()</span><br/><span class="hl-10">              .</span><span class="hl-4">then</span><span class="hl-10">(() </span><span class="hl-2">=&gt;</span><span class="hl-10"> </span><span class="hl-0">console</span><span class="hl-10">.</span><span class="hl-4">log</span><span class="hl-10">(</span><span class="hl-5">&#39;Done&#39;</span><span class="hl-10">))</span><br/><span class="hl-10">              .</span><span class="hl-4">catch</span><span class="hl-10">(</span><span class="hl-0">console</span><span class="hl-10">.</span><span class="hl-0">log</span><span class="hl-10">);</span><br/><span class="hl-10">          }</span><span class="hl-2">}</span><br/><span class="hl-10">        </span><span class="hl-11">&gt;</span><br/><span class="hl-10">          Log Out</span><br/><span class="hl-10">        </span><span class="hl-11">&lt;/</span><span class="hl-12">button</span><span class="hl-11">&gt;</span><br/><span class="hl-10">      ) </span><span class="hl-1">:</span><span class="hl-10"> (</span><br/><span class="hl-10">        </span><span class="hl-11">&lt;</span><span class="hl-12">button</span><br/><span class="hl-10">          </span><span class="hl-13">onClick</span><span class="hl-1">=</span><span class="hl-2">{</span><span class="hl-10">() </span><span class="hl-2">=&gt;</span><span class="hl-10"> {</span><br/><span class="hl-10">            </span><span class="hl-4">logIn</span><span class="hl-10">(</span><span class="hl-0">signer</span><span class="hl-10">)</span><br/><span class="hl-10">              .</span><span class="hl-4">then</span><span class="hl-10">((</span><span class="hl-0">user</span><span class="hl-10">) </span><span class="hl-2">=&gt;</span><span class="hl-10"> </span><span class="hl-0">console</span><span class="hl-10">.</span><span class="hl-4">log</span><span class="hl-10">(</span><span class="hl-5">&#39;Done&#39;</span><span class="hl-10">, </span><span class="hl-0">user</span><span class="hl-10">))</span><br/><span class="hl-10">              .</span><span class="hl-4">catch</span><span class="hl-10">(</span><span class="hl-0">console</span><span class="hl-10">.</span><span class="hl-0">log</span><span class="hl-10">);</span><br/><span class="hl-10">          }</span><span class="hl-2">}</span><br/><span class="hl-10">        </span><span class="hl-11">&gt;</span><br/><span class="hl-10">          Log In</span><br/><span class="hl-10">        </span><span class="hl-11">&lt;/</span><span class="hl-12">button</span><span class="hl-11">&gt;</span><br/><span class="hl-10">      )</span><span class="hl-2">}</span><br/><span class="hl-1">    </span><span class="hl-11">&lt;/</span><span class="hl-12">div</span><span class="hl-11">&gt;</span><br/><span class="hl-1">  );</span><br/><span class="hl-1">};</span>
</code></pre>

<a href="#logging-in-via-a-transaction" id="logging-in-via-a-transaction" style="color: inherit; text-decoration: none;">
  <h2>Logging in via a Transaction</h2>
</a>
<p>If the user&#39;s wallet does not support <code>signMessage</code>, we need to sign in via a transaction. This involves three steps:</p>
<ul>
<li>Obtain nonce from Notifi and hash it</li>
<li>Broadcast a transaction which will print the hash</li>
<li>Complete the login with Notifi by submitting the transaction signature</li>
</ul>

<a href="#obtaining-a-nonce-from-notifi" id="obtaining-a-nonce-from-notifi" style="color: inherit; text-decoration: none;">
  <h3>Obtaining a nonce from Notifi</h3>
</a>
<pre><code class="language-tsx"><span class="hl-2">const</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">beginLoginViaTransaction</span><span class="hl-1">,</span><br/><span class="hl-1">} = </span><span class="hl-4">useNotifiClient</span><span class="hl-1">({ ... });</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">getHashedNonce</span><span class="hl-1"> = </span><span class="hl-4">useCallback</span><span class="hl-1">(</span><span class="hl-2">async</span><span class="hl-1"> (): </span><span class="hl-6">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">string</span><span class="hl-1">&gt; </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> { </span><span class="hl-3">logValue</span><span class="hl-1"> } = </span><span class="hl-7">await</span><span class="hl-1"> </span><span class="hl-4">beginLoginViaTransaction</span><span class="hl-1">();</span><br/><span class="hl-1">  </span><span class="hl-7">return</span><span class="hl-1"> </span><span class="hl-0">logValue</span><span class="hl-1">;</span><br/><span class="hl-1">}, [</span><span class="hl-0">beginLoginViaTransaction</span><span class="hl-1">]);</span>
</code></pre>

<a href="#broadcast-a-transaction" id="broadcast-a-transaction" style="color: inherit; text-decoration: none;">
  <h3>Broadcast a transaction</h3>
</a>
<pre><code class="language-tsx"><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">broadcastTxn</span><span class="hl-1"> = </span><span class="hl-4">useCallback</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-2">async</span><span class="hl-1"> (</span><span class="hl-0">logValue</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">): </span><span class="hl-6">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">string</span><span class="hl-1">&gt; </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-0">logValue</span><span class="hl-1"> === </span><span class="hl-5">&#39;&#39;</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-7">throw</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-6">Error</span><span class="hl-1">(</span><span class="hl-5">&#39;Invalid log value&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">txn</span><span class="hl-1"> = </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-4">Transaction</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-0">txn</span><span class="hl-1">.</span><span class="hl-4">add</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-4">TransactionInstruction</span><span class="hl-1">({</span><br/><span class="hl-1">        </span><span class="hl-0">keys:</span><span class="hl-1"> [</span><br/><span class="hl-1">          {</span><br/><span class="hl-1">            </span><span class="hl-0">pubkey</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-0">isSigner:</span><span class="hl-1"> </span><span class="hl-2">true</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-0">isWritable:</span><span class="hl-1"> </span><span class="hl-2">false</span><span class="hl-1">,</span><br/><span class="hl-1">          },</span><br/><span class="hl-1">        ],</span><br/><span class="hl-1">        </span><span class="hl-0">data:</span><span class="hl-1"> </span><span class="hl-0">Buffer</span><span class="hl-1">.</span><span class="hl-4">from</span><span class="hl-1">(</span><span class="hl-0">msg</span><span class="hl-1">, </span><span class="hl-5">&#39;utf-8&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">        </span><span class="hl-0">programId:</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-4">PublicKey</span><span class="hl-1">(</span><span class="hl-5">&#39;MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">      }),</span><br/><span class="hl-1">    );</span><br/><br/><span class="hl-1">    </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">broadcasted</span><span class="hl-1"> = </span><span class="hl-7">await</span><span class="hl-1"> </span><span class="hl-0">wallet</span><span class="hl-1">.</span><span class="hl-4">sendTransaction</span><span class="hl-1">(</span><span class="hl-0">txn</span><span class="hl-1">, </span><span class="hl-0">connection</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-7">return</span><span class="hl-1"> </span><span class="hl-0">broadcasted</span><span class="hl-1">;</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  [</span><span class="hl-0">pubkey</span><span class="hl-1">, </span><span class="hl-0">wallet</span><span class="hl-1">, </span><span class="hl-0">connection</span><span class="hl-1">],</span><br/><span class="hl-1">);</span>
</code></pre>

<a href="#complete-login" id="complete-login" style="color: inherit; text-decoration: none;">
  <h3>Complete login</h3>
</a>
<pre><code class="language-tsx"><span class="hl-2">const</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-3">completeLoginViaTransaction</span><span class="hl-1">,</span><br/><span class="hl-1">} = </span><span class="hl-4">useNotifiClient</span><span class="hl-1">({ ... });</span><br/><br/><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">completeLogin</span><span class="hl-1"> = </span><span class="hl-4">useCallback</span><span class="hl-1">(</span><span class="hl-2">async</span><span class="hl-1"> (</span><span class="hl-0">transactionSignature</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">): </span><span class="hl-6">Promise</span><span class="hl-1">&lt;</span><span class="hl-6">User</span><span class="hl-1">&gt; </span><span class="hl-2">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-3">result</span><span class="hl-1"> = </span><span class="hl-7">await</span><span class="hl-1"> </span><span class="hl-4">completeLoginViaTransaction</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-0">transactionSignature</span><span class="hl-1">,</span><br/><span class="hl-1">  });</span><br/><span class="hl-1">  </span><span class="hl-7">return</span><span class="hl-1"> </span><span class="hl-0">result</span><span class="hl-1">;</span><br/><span class="hl-1">}, [</span><span class="hl-0">completeLoginViaTransaction</span><span class="hl-1">]);</span>
</code></pre>
</div></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class="current"><a href="modules.html">Exports</a></li><li class=" tsd-kind-namespace"><a href="modules/_internal_.html">&lt;internal&gt;</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="tsd-kind-enum"><a href="enums/BlockchainEnvironment.html" class="tsd-kind-icon">Blockchain<wbr/>Environment</a></li><li class="tsd-kind-class"><a href="classes/GqlError.html" class="tsd-kind-icon">Gql<wbr/>Error</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Alert" class="tsd-kind-icon">Alert</a></li><li class="tsd-kind-type-alias"><a href="modules.html#AlertFrequency" class="tsd-kind-icon">Alert<wbr/>Frequency</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ClientConfiguration" class="tsd-kind-icon">Client<wbr/>Configuration</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ClientCreateAlertInput" class="tsd-kind-icon">Client<wbr/>Create<wbr/>Alert<wbr/>Input</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ClientData" class="tsd-kind-icon">Client<wbr/>Data</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ClientDeleteAlertInput" class="tsd-kind-icon">Client<wbr/>Delete<wbr/>Alert<wbr/>Input</a></li><li class="tsd-kind-type-alias"><a href="modules.html#ClientUpdateAlertInput" class="tsd-kind-icon">Client<wbr/>Update<wbr/>Alert<wbr/>Input</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Filter" class="tsd-kind-icon">Filter</a></li><li class="tsd-kind-type-alias"><a href="modules.html#FilterOptions" class="tsd-kind-icon">Filter<wbr/>Options</a></li><li class="tsd-kind-type-alias"><a href="modules.html#MessageSigner" class="tsd-kind-icon">Message<wbr/>Signer</a></li><li class="tsd-kind-type-alias"><a href="modules.html#NotifiClient" class="tsd-kind-icon">Notifi<wbr/>Client</a></li><li class="tsd-kind-type-alias"><a href="modules.html#NotifiEnvironment" class="tsd-kind-icon">Notifi<wbr/>Environment</a></li><li class="tsd-kind-type-alias"><a href="modules.html#Source" class="tsd-kind-icon">Source</a></li><li class="tsd-kind-type-alias"><a href="modules.html#SourceGroup" class="tsd-kind-icon">Source<wbr/>Group</a></li><li class="tsd-kind-type-alias"><a href="modules.html#TargetGroup" class="tsd-kind-icon">Target<wbr/>Group</a></li><li class="tsd-kind-type-alias"><a href="modules.html#TargetType" class="tsd-kind-icon">Target<wbr/>Type</a></li><li class="tsd-kind-type-alias"><a href="modules.html#User" class="tsd-kind-icon">User</a></li><li class="tsd-kind-function"><a href="modules.html#isAlertObsolete" class="tsd-kind-icon">is<wbr/>Alert<wbr/>Obsolete</a></li><li class="tsd-kind-function"><a href="modules.html#isAlertPaused" class="tsd-kind-icon">is<wbr/>Alert<wbr/>Paused</a></li><li class="tsd-kind-function"><a href="modules.html#useNotifiClient" class="tsd-kind-icon">use<wbr/>Notifi<wbr/>Client</a></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li><li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="assets/main.js"></script></body></html>